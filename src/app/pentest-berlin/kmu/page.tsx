import { Metadata } from 'next';
import Link from 'next/link';
import { Calculator, CheckCircle, ArrowRight, Shield, AlertTriangle, Building2, ChevronRight } from 'lucide-react';

const baseUrl = 'https://www.sodusecure.com';

export const metadata: Metadata = {
  title: 'Pentest Berlin für KMU – Penetrationstest für kleine & mittlere Unternehmen | SODU Secure',
  description: 'Pentest Berlin für KMU: 62 % aller Cyberangriffe treffen KMUs. Maßgeschneiderte Penetrationstests für kleine und mittlere Unternehmen in Berlin – ab 8.000 €. NIS2-konform.',
  keywords: [
    'Pentest Berlin KMU',
    'Penetrationstest KMU Berlin',
    'Cybersecurity KMU Berlin',
    'IT-Sicherheit Mittelstand Berlin',
    'Pentest kleine Unternehmen Berlin',
    'NIS2 KMU Pentest',
    'Pentest Mittelstand Berlin',
    'Sicherheitstest KMU',
  ],
  alternates: {
    canonical: `${baseUrl}/pentest-berlin/kmu`,
  },
  openGraph: {
    title: 'Pentest Berlin für KMU – Penetrationstest für den Mittelstand',
    description: '62 % aller Cyberangriffe treffen KMUs. Maßgeschneiderte Pentests für Berliner KMUs – NIS2-konform, ab 8.000 €.',
    url: `${baseUrl}/pentest-berlin/kmu`,
    type: 'website',
  },
  robots: { index: true, follow: true },
};

const jsonLdFaq = {
  '@context': 'https://schema.org',
  '@type': 'FAQPage',
  mainEntity: [
    {
      '@type': 'Question',
      name: 'Warum sind KMUs besonders häufig Ziel von Cyberangriffen?',
      acceptedAnswer: {
        '@type': 'Answer',
        text: 'KMUs haben im Vergleich zu Großunternehmen oft weniger IT-Ressourcen, veraltete Software und keine dedizierten Sicherheitsteams – und sind damit für automatisierte Angriffe leichtere Ziele. Laut Bitkom 2024 waren 81 % der befragten deutschen Unternehmen Opfer von Cyberangriffen, der Mittelstand überproportional betroffen.',
      },
    },
    {
      '@type': 'Question',
      name: 'Bin ich als KMU von NIS2 betroffen?',
      acceptedAnswer: {
        '@type': 'Answer',
        text: 'NIS2 gilt für "wichtige Einrichtungen" ab 50 Mitarbeitern oder 10 Mio. € Jahresumsatz in Sektoren wie IT, Energie, Produktion, Lebensmittel, Logistik oder Gesundheit. Ein Pentest ist zwar nicht explizit vorgeschrieben, gilt aber als Nachweis für "angemessene Sicherheitsmaßnahmen" nach Art. 21 NIS2. Quelle: BSI NIS-2.',
      },
    },
    {
      '@type': 'Question',
      name: 'Was kostet ein KMU-Pentest in Berlin?',
      acceptedAnswer: {
        '@type': 'Answer',
        text: 'Ein vollständiger KMU-Pentest (extern + Active Directory + optional Phishing-Simulation) kostet bei SODU Secure ab 8.000 €. Der genaue Preis hängt von der Anzahl der Systeme und dem gewünschten Testumfang ab.',
      },
    },
    {
      '@type': 'Question',
      name: 'Wie lange dauert ein KMU-Pentest?',
      acceptedAnswer: {
        '@type': 'Answer',
        text: 'Ein typischer KMU-Pentest dauert 2–3 Wochen vom Kick-off bis zur Abschlusspräsentation. Vorbereitung und NDA-Unterzeichnung: 1–2 Tage. Aktive Testphase: 7–10 Werktage. Berichtserstellung: 3–5 Tage.',
      },
    },
    {
      '@type': 'Question',
      name: 'Gibt es einen kostenlosen Pentest für Berliner KMUs?',
      acceptedAnswer: {
        '@type': 'Answer',
        text: 'Ja. Im Rahmen des SODU Secure Berlin KMU Pilotprogramms 2026 bieten wir einem ausgewählten Berliner KMU einen vollständigen Pentest im Wert von bis zu 15.000 € kostenfrei an. Bewerben Sie sich unter sodusecure.com/berlin-kmu-pilot.',
      },
    },
    {
      '@type': 'Question',
      name: 'Was sind die häufigsten Schwachstellen bei KMUs in Berlin?',
      acceptedAnswer: {
        '@type': 'Answer',
        text: 'Die häufigsten Findings in KMU-Pentests: (1) Schwache Active-Directory-Konfigurationen mit Kerberoasting-Anfälligkeit, (2) Veraltete VPN-Systeme oder Remote-Desktop-Dienste ohne MFA, (3) Fehlkonfigurierte Cloud-Speicher (S3, Azure Blob), (4) OWASP-Top-10-Lücken in internen Webanwendungen, (5) Unsichere Default-Credentials auf Netzwerkgeräten.',
      },
    },
  ],
};

const jsonLdBreadcrumb = {
  '@context': 'https://schema.org',
  '@type': 'BreadcrumbList',
  itemListElement: [
    { '@type': 'ListItem', position: 1, name: 'SODU Secure', item: baseUrl },
    { '@type': 'ListItem', position: 2, name: 'Pentest Berlin', item: `${baseUrl}/pentest-berlin` },
    { '@type': 'ListItem', position: 3, name: 'Pentest Berlin KMU', item: `${baseUrl}/pentest-berlin/kmu` },
  ],
};

const kmuStats = [
  { value: '81 %', label: 'dt. Unternehmen Opfer von Cyberangriffen', source: 'Bitkom 2024' },
  { value: '62 %', label: 'aller Angriffe treffen KMUs', source: 'Verizon DBIR 2024' },
  { value: '60 %', label: 'angegriffener KMUs gehen innerhalb von 6 Monaten insolvent', source: 'U.S. NCSA' },
  { value: '4,9 Mio. €', label: 'Ø Kosten eines Sicherheitsvorfalls in DE', source: 'IBM 2024' },
];

const kmuTestAreas = [
  { title: 'Externer Netzwerk-Pentest', desc: 'Scan und Exploitation aller öffentlichen IPs, offenen Ports, Remote-Access-Dienste (VPN, RDP, SSH). Identifikation von CVEs in produktiven Systemen.', icon: Shield },
  { title: 'Web Application Pentest', desc: 'OWASP Top 10, Business Logic Fehler, API-Sicherheit. Prüfung Ihrer Webapplikationen auf ausnutzbare Schwachstellen.', icon: Shield },
  { title: 'Active Directory Assessment', desc: 'Kerberoasting, Pass-the-Hash, ACL-Misconfigurations, Privilegien-Eskalation. Die häufigste Angriffsfläche im Berliner Mittelstand.', icon: Shield },
  { title: 'Phishing-Simulation', desc: 'Realistische Spear-Phishing-Kampagne gegen Ihre Mitarbeiter. Klickrate-Auswertung + Awareness-Empfehlungen für Ihre Security-Schulung.', icon: Shield },
  { title: 'Cloud Security Review', desc: 'Prüfung von AWS/Azure/GCP-Konfigurationen: S3-Bucket-Berechtigungen, IAM-Policies, öffentliche Endpunkte, Secrets in Code-Repos.', icon: Shield },
  { title: 'Management-Summary & Re-Test', desc: 'Abschlussbericht mit Management-Summary für Geschäftsführung und technischem Report für IT-Team. Re-Test kritischer Findings inklusive.', icon: Building2 },
];

export default function KmuPage() {
  return (
    <>
      <script type="application/ld+json" dangerouslySetInnerHTML={{ __html: JSON.stringify(jsonLdFaq) }} />
      <script type="application/ld+json" dangerouslySetInnerHTML={{ __html: JSON.stringify(jsonLdBreadcrumb) }} />

      <main className="bg-[#0d1117] min-h-screen text-white">

        {/* Breadcrumb */}
        <div className="bg-[#131927] border-b border-gray-800">
          <div className="container mx-auto px-4 sm:px-6 py-3">
            <nav className="flex items-center gap-2 text-sm text-gray-400" aria-label="Breadcrumb">
              <Link href="/" className="hover:text-white transition-colors">SODU Secure</Link>
              <ChevronRight className="w-3 h-3" />
              <Link href="/pentest-berlin" className="hover:text-white transition-colors">Pentest Berlin</Link>
              <ChevronRight className="w-3 h-3" />
              <span className="text-white">Pentest für KMU</span>
            </nav>
          </div>
        </div>

        {/* Hero */}
        <section className="py-16 sm:py-20 bg-gradient-to-b from-[#131927] to-[#0d1117]">
          <div className="container mx-auto px-4 sm:px-6 max-w-5xl text-center">
            <div className="inline-block bg-orange-600/10 border border-orange-500/30 rounded-full px-4 py-1.5 text-orange-400 text-sm font-medium mb-6">
              Berliner Mittelstand & KMU
            </div>
            <h1 className="text-3xl sm:text-4xl lg:text-5xl font-bold mb-6 leading-tight">
              Pentest Berlin für{' '}
              <span className="text-red-500">KMU</span>
            </h1>
            <p className="text-gray-300 text-lg sm:text-xl max-w-3xl mx-auto mb-8">
              62 % aller Cyberangriffe weltweit treffen kleine und mittlere Unternehmen.
              Berliner KMUs sind ein bevorzugtes Ziel — weil automatisierte Angriffe keine Unternehmensgröße kennen.
            </p>
            <div className="flex flex-col sm:flex-row items-center justify-center gap-4">
              <Link
                href="/request-pentest"
                className="inline-flex items-center gap-2 bg-red-600 hover:bg-red-700 text-white px-8 py-3 rounded-lg font-semibold transition-colors text-base"
              >
                <Calculator className="w-5 h-5" />
                KMU Pentest Konfigurieren
              </Link>
              <Link
                href="/berlin-kmu-pilot"
                className="inline-flex items-center gap-2 border border-green-500/50 text-green-400 hover:bg-green-500/10 px-6 py-3 rounded-lg font-medium transition-colors text-sm"
              >
                Kostenloser Pilot-Pentest →
              </Link>
            </div>
          </div>
        </section>

        {/* Stats */}
        <section className="py-10 bg-[#131927] border-y border-gray-800">
          <div className="container mx-auto px-4 sm:px-6 max-w-5xl">
            <div className="grid grid-cols-2 lg:grid-cols-4 gap-6">
              {kmuStats.map((s, i) => (
                <div key={i} className="text-center">
                  <div className="text-2xl sm:text-3xl font-bold text-red-500">{s.value}</div>
                  <div className="text-xs sm:text-sm text-gray-300 mt-1">{s.label}</div>
                  <div className="text-xs text-gray-500 mt-1">({s.source})</div>
                </div>
              ))}
            </div>
          </div>
        </section>

        {/* Why KMUs are targeted */}
        <section className="py-16 sm:py-20">
          <div className="container mx-auto px-4 sm:px-6 max-w-5xl">
            <div className="grid grid-cols-1 lg:grid-cols-2 gap-10 items-center">
              <div>
                <h2 className="text-2xl sm:text-3xl font-bold mb-6">
                  Warum Angreifer{' '}
                  <span className="text-red-500">KMUs bevorzugen</span>
                </h2>
                <div className="space-y-4">
                  {[
                    { title: 'Kein dediziertes Security-Team', desc: 'IT wird oft nebenbei durch Generalisten betrieben — keine Zeit für proaktive Sicherheit.' },
                    { title: 'Veraltete Software & Updates', desc: 'Patch-Management ist aufwendig. Bekannte CVEs bleiben Monate ungepatcht.' },
                    { title: 'Fehlkonfiguriertes Active Directory', desc: 'Standard-AD-Konfigurationen sind für Angreifer trivial. Kerberoasting, Pass-the-Hash, ACM-Misconfiguration.' },
                    { title: 'Zugang zu Lieferketten', desc: 'KMUs sind Zulieferer großer Unternehmen — ein KMU-Hack ist der Einstiegspunkt für Lieferketten-Angriffe.' },
                    { title: 'Kein Incident Response Plan', desc: 'Ohne Plan zahlt ein KMU nach einem Angriff doppelt: Bereinigung + Ausfallzeit + Datenschutzmeldung.' },
                  ].map((item, i) => (
                    <div key={i} className="flex gap-4 bg-[#131927] rounded-xl p-4 border border-gray-800">
                      <AlertTriangle className="w-5 h-5 text-red-400 shrink-0 mt-0.5" />
                      <div>
                        <h3 className="font-semibold text-white text-sm mb-1">{item.title}</h3>
                        <p className="text-xs text-gray-400">{item.desc}</p>
                      </div>
                    </div>
                  ))}
                </div>
              </div>
              <div className="bg-[#131927] rounded-2xl border border-gray-800 p-6 sm:p-8">
                <h3 className="font-bold text-white text-lg mb-4">Der typische KMU-Angriffsablauf</h3>
                <div className="space-y-4">
                  {[
                    { step: '1', title: 'Automatisierter Scan', desc: 'Shodan, Censys und Masscan scannen permanent das Internet auf offene Ports, veraltete Software und bekannte CVEs.' },
                    { step: '2', title: 'Initialer Zugang', desc: 'Ausnutzung einer CVE in VPN, Webserver oder Mail-Lösung. Alternativ: Phishing-Mail an Mitarbeiter.' },
                    { step: '3', title: 'Laterale Bewegung', desc: 'NTLM-Relay, Pass-the-Hash oder Kerberoasting im Active Directory. Ausbreitung auf alle Systeme.' },
                    { step: '4', title: 'Exfiltration + Ransomware', desc: 'Datenkopie → Verschlüsselung → Lösegeld. Ø Forderung KMU: 100.000–500.000 € (FBI 2024).' },
                  ].map((s, i) => (
                    <div key={i} className="flex gap-3">
                      <div className="w-7 h-7 bg-red-600 rounded-full flex items-center justify-center text-xs font-bold shrink-0">{s.step}</div>
                      <div>
                        <div className="font-medium text-white text-sm">{s.title}</div>
                        <div className="text-xs text-gray-400 mt-0.5">{s.desc}</div>
                      </div>
                    </div>
                  ))}
                </div>
              </div>
            </div>
          </div>
        </section>

        {/* What a KMU pentest covers */}
        <section className="py-16 sm:py-20 bg-[#131927]">
          <div className="container mx-auto px-4 sm:px-6 max-w-6xl">
            <h2 className="text-2xl sm:text-3xl font-bold text-center mb-4">Was ein KMU-Pentest in Berlin abdeckt</h2>
            <p className="text-gray-400 text-center max-w-2xl mx-auto mb-12 text-sm sm:text-base">
              Kein Standardpaket — jeder KMU-Pentest wird auf Ihre Infrastruktur zugeschnitten.
            </p>
            <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
              {kmuTestAreas.map((area, i) => (
                <div key={i} className="bg-[#0d1117] rounded-xl border border-gray-800 p-6">
                  <h3 className="font-semibold text-white mb-2 text-sm">{area.title}</h3>
                  <p className="text-xs text-gray-400 leading-relaxed">{area.desc}</p>
                </div>
              ))}
            </div>
          </div>
        </section>

        {/* NIS2 Box */}
        <section className="py-16 sm:py-20">
          <div className="container mx-auto px-4 sm:px-6 max-w-4xl">
            <div className="bg-gradient-to-r from-blue-950/40 to-indigo-950/30 border border-blue-500/30 rounded-2xl p-8 sm:p-10">
              <h2 className="text-xl sm:text-2xl font-bold text-white mb-4">NIS2 und der Berliner Mittelstand</h2>
              <p className="text-gray-300 text-sm sm:text-base mb-4">
                Die NIS2-Richtlinie (seit Oktober 2024 in nationales Recht umzusetzen) verpflichtet{' '}
                <strong className="text-white">wichtige Einrichtungen ab 50 Mitarbeitern oder 10 Mio. € Jahresumsatz</strong>{' '}
                in relevanten Sektoren zu technischen Risikomanagementmaßnahmen — darunter regelmäßige Sicherheitsprüfungen.
              </p>
              <p className="text-gray-300 text-sm sm:text-base mb-6">
                Ein Penetrationstest ist die stärkste Form des Nachweises für{' '}
                <strong className="text-white">&bdquo;angemessene Sicherheitsmaßnahmen&ldquo;</strong>{' '}
                nach Art. 21 NIS2. Das BSI empfiehlt Pentests als Teil des IT-Grundschutz-Prozesses.
              </p>
              <div className="flex flex-col sm:flex-row gap-4">
                <Link href="/request-pentest" className="inline-flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-6 py-2.5 rounded-lg font-medium transition-colors text-sm">
                  NIS2-konformen Pentest anfragen
                </Link>
                <a href="https://www.bsi.bund.de/DE/Themen/Regulierter-Bereich/NIS-2/nis-2_node.html" target="_blank" rel="noopener noreferrer" className="inline-flex items-center gap-2 text-blue-400 hover:text-blue-300 transition-colors text-sm">
                  BSI NIS-2 Seite →
                </a>
              </div>
            </div>
          </div>
        </section>

        {/* Before / After */}
        <section className="py-16 sm:py-20 bg-[#131927]">
          <div className="container mx-auto px-4 sm:px-6 max-w-4xl">
            <h2 className="text-2xl sm:text-3xl font-bold text-center mb-12">Was ein KMU nach dem Pentest hat</h2>
            <div className="grid grid-cols-1 sm:grid-cols-2 gap-6">
              <div className="bg-red-950/20 border border-red-500/30 rounded-xl p-6">
                <h3 className="font-semibold text-red-400 mb-4">Vor dem Pentest</h3>
                <ul className="space-y-2">
                  {[
                    'Keine Kenntnis realer Angriffsvektoren',
                    'AD-Konfiguration nie extern geprüft',
                    'Kein Überblick über exponierte Systeme',
                    'Kein NIS2 / Versicherungsnachweis',
                    'Keine priorisierten Maßnahmen',
                  ].map((item, i) => (
                    <li key={i} className="flex items-center gap-2 text-sm text-gray-300">
                      <span className="text-red-500 text-lg leading-none">✗</span>
                      {item}
                    </li>
                  ))}
                </ul>
              </div>
              <div className="bg-green-950/20 border border-green-500/30 rounded-xl p-6">
                <h3 className="font-semibold text-green-400 mb-4">Nach dem Pentest</h3>
                <ul className="space-y-2">
                  {[
                    'Klarer Bericht aller Schwachstellen (CVSS)',
                    'Priorisierte Maßnahmenliste für IT-Team',
                    'Management-Summary für Geschäftsführung',
                    'Nachweis für NIS2, ISO 27001, Cyberversicherung',
                    'Re-Test-Check für kritische Findings',
                  ].map((item, i) => (
                    <li key={i} className="flex items-center gap-2 text-sm text-gray-300">
                      <CheckCircle className="w-4 h-4 text-green-400 shrink-0" />
                      {item}
                    </li>
                  ))}
                </ul>
              </div>
            </div>
          </div>
        </section>

        {/* Pilot program */}
        <section className="py-12">
          <div className="container mx-auto px-4 sm:px-6 max-w-4xl">
            <div className="bg-gradient-to-r from-green-950/40 to-emerald-950/30 border border-green-500/30 rounded-2xl p-6 sm:p-8 text-center">
              <div className="inline-block bg-green-500/10 border border-green-500/30 text-green-400 text-xs font-bold px-3 py-1 rounded-full mb-4">
                Berlin KMU Pilotprogramm 2026
              </div>
              <h2 className="text-xl sm:text-2xl font-bold text-white mb-3">
                Kostenloser Pentest für ein Berliner KMU
              </h2>
              <p className="text-gray-300 text-sm mb-6 max-w-xl mx-auto">
                Im Rahmen unseres Pilotprogramms 2026 bieten wir einem ausgewählten Berliner KMU einen vollständigen Pentest im Wert von bis zu <strong className="text-white">15.000 € kostenfrei</strong> an.
              </p>
              <Link href="/berlin-kmu-pilot" className="inline-flex items-center gap-2 bg-green-600 hover:bg-green-700 text-white px-6 py-2.5 rounded-lg font-medium transition-colors text-sm">
                Jetzt für Pilot bewerben
                <ArrowRight className="w-4 h-4" />
              </Link>
            </div>
          </div>
        </section>

        {/* FAQ */}
        <section className="py-16 sm:py-20 bg-[#131927]">
          <div className="container mx-auto px-4 sm:px-6 max-w-3xl">
            <h2 className="text-2xl sm:text-3xl font-bold text-center mb-12">Häufige Fragen: Pentest für KMU Berlin</h2>
            <div className="space-y-4">
              {jsonLdFaq.mainEntity.map((qa, i) => (
                <details key={i} className="bg-[#0d1117] border border-gray-800 rounded-xl p-6 group">
                  <summary className="cursor-pointer font-semibold text-white list-none flex items-center justify-between gap-4">
                    <span>{qa.name}</span>
                    <ChevronRight className="w-4 h-4 text-gray-400 group-open:rotate-90 transition-transform shrink-0" />
                  </summary>
                  <p className="mt-4 text-gray-400 text-sm leading-relaxed">{qa.acceptedAnswer.text}</p>
                </details>
              ))}
            </div>
          </div>
        </section>

        {/* Related cluster */}
        <section className="py-12 border-t border-gray-800">
          <div className="container mx-auto px-4 sm:px-6 max-w-5xl">
            <h2 className="text-lg font-semibold text-white mb-6 text-center">Weitere Themen rund um Pentest Berlin</h2>
            <div className="grid grid-cols-1 sm:grid-cols-3 gap-4">
              {[
                { href: '/pentest-berlin/kosten', title: 'Was kostet ein Pentest in Berlin?', desc: 'Transparente Preise, Pakete und Kostenfaktoren für Berliner Unternehmen.' },
                { href: '/pentest-berlin/intern-extern', title: 'Interner vs. Externer Pentest', desc: 'Was ist der Unterschied und wann brauchen KMUs welchen Ansatz?' },
                { href: '/pentest-berlin/iso-27001', title: 'ISO 27001 Pentest Berlin', desc: 'Welche Pentests für ISO 27001 und NIS2-Compliance notwendig sind.' },
              ].map((link) => (
                <Link key={link.href} href={link.href} className="bg-[#131927] border border-gray-800 rounded-xl p-5 hover:border-red-500/50 transition-colors group">
                  <div className="flex items-center justify-between mb-2">
                    <h3 className="font-semibold text-white text-sm group-hover:text-red-400 transition-colors">{link.title}</h3>
                    <ArrowRight className="w-4 h-4 text-gray-500 group-hover:text-red-400 transition-colors shrink-0" />
                  </div>
                  <p className="text-xs text-gray-400">{link.desc}</p>
                </Link>
              ))}
            </div>
          </div>
        </section>

        {/* CTA */}
        <section className="py-16 sm:py-20 bg-gradient-to-b from-[#0d1117] to-[#131927]">
          <div className="container mx-auto px-4 sm:px-6 max-w-3xl text-center">
            <h2 className="text-2xl sm:text-3xl font-bold mb-4">KMU-Pentest in Berlin anfragen</h2>
            <p className="text-gray-400 mb-8 text-sm sm:text-base">
              Kostenloses Erstgespräch — kein Verkaufsdruck. Wir besprechen Ihren Scope und erstellen ein verbindliches Festpreisangebot.
            </p>
            <Link
              href="/request-pentest"
              className="inline-flex items-center gap-2 bg-red-600 hover:bg-red-700 text-white px-8 py-4 rounded-lg font-semibold text-base transition-colors"
            >
              <Calculator className="w-5 h-5" />
              KMU Pentest Kosten Berechnen
              <ArrowRight className="w-5 h-5" />
            </Link>
            <div className="mt-4">
              <Link href="/pentest-berlin" className="text-sm text-gray-500 hover:text-gray-300 transition-colors">
                ← Zurück zur Pentest Berlin Übersicht
              </Link>
            </div>
          </div>
        </section>
      </main>
    </>
  );
}
