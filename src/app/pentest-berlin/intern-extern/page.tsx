import { Metadata } from 'next';
import Link from 'next/link';
import { Calculator, CheckCircle, ArrowRight, ChevronRight, X } from 'lucide-react';

const baseUrl = 'https://www.sodusecure.com';

export const metadata: Metadata = {
  title: 'Externer vs. Interner Pentest Berlin – Was ist der Unterschied? | SODU Secure',
  description: 'Externer Pentest vs. Interner Pentest Berlin: Was sind die Unterschiede, wann brauchen Sie welchen Ansatz und wie kombinieren Sie beide für maximalen Schutz? SODU Secure erklärt.',
  keywords: [
    'Externer Pentest Berlin',
    'Interner Pentest Berlin',
    'externer vs interner Pentest',
    'Penetrationstest intern extern Berlin',
    'Black Box Pentest Berlin',
    'Grey Box Pentest Berlin',
    'Netzwerk Pentest Berlin',
    'Active Directory Pentest Berlin intern',
  ],
  alternates: {
    canonical: `${baseUrl}/pentest-berlin/intern-extern`,
  },
  openGraph: {
    title: 'Externer vs. Interner Pentest Berlin – Was ist der Unterschied?',
    description: 'Klar erklärt: Unterschiede zwischen externem und internem Pentest Berlin, wann Sie welchen brauchen und was ein hybrider Ansatz kostet.',
    url: `${baseUrl}/pentest-berlin/intern-extern`,
    type: 'website',
  },
  robots: { index: true, follow: true },
};

const jsonLdFaq = {
  '@context': 'https://schema.org',
  '@type': 'FAQPage',
  mainEntity: [
    {
      '@type': 'Question',
      name: 'Was ist ein externer Penetrationstest?',
      acceptedAnswer: {
        '@type': 'Answer',
        text: 'Ein externer Pentest simuliert einen Angreifer aus dem Internet ohne Vorwissen über Ihre Infrastruktur. Der Tester greift von außen auf Ihre öffentlichen IPs, Domains, Webserver, VPNs und Mailserver an – so wie ein echter Angreifer es tun würde. Ziel: Identifikation aller von außen erreichbaren Schwachstellen.',
      },
    },
    {
      '@type': 'Question',
      name: 'Was ist ein interner Penetrationstest?',
      acceptedAnswer: {
        '@type': 'Answer',
        text: 'Ein interner Pentest simuliert einen Angreifer, der bereits im Netzwerk ist – z. B. nach einem Phishing-Angriff oder durch einen böswilligen Mitarbeiter. Der Tester erhält Zugang zu einem internen System und versucht, sich lateral durch das Netzwerk zu bewegen, Privilegien zu eskalieren und sensible Daten zu erreichen.',
      },
    },
    {
      '@type': 'Question',
      name: 'Was ist der Unterschied zwischen Black-Box, Grey-Box und White-Box Pentest?',
      acceptedAnswer: {
        '@type': 'Answer',
        text: 'Black-Box: Kein Vorwissen, simuliert realen externen Angreifer. Grey-Box: Teilweises Vorwissen (z.B. ein normaler Benutzeraccount), effizienteres Testen. White-Box: Vollständiges Vorwissen inklusive Architektur, Quellcode und Credentials – tiefste Testabdeckung. Für KMUs empfiehlt sich Grey-Box extern + White-Box intern.',
      },
    },
    {
      '@type': 'Question',
      name: 'Brauche ich als Berliner KMU einen internen oder externen Pentest?',
      acceptedAnswer: {
        '@type': 'Answer',
        text: 'Idealerweise beides – aber wenn Sie mit einem starten müssen: Beginnen Sie mit einem externen Pentest (geringerer Aufwand, direkte Angriffsfläche aus dem Internet). Im zweiten Schritt folgt der interne Pentest (Active Directory, laterale Bewegung). SODU Secure kombiniert beides im KMU-Paket.',
      },
    },
    {
      '@type': 'Question',
      name: 'Was kostet ein externer Pentest in Berlin?',
      acceptedAnswer: {
        '@type': 'Answer',
        text: 'Ein fokussierter externer Netzwerk-Pentest (bis 20 IPs / Domains) kostet ab 2.500 €. Ein umfangreicherer externer Pentest mit Webapplikationen, VPN und Mailserver kostet zwischen 4.000 und 8.000 €. Ein vollständiges KMU-Paket (extern + intern + AD) beginnt bei 8.000 €.',
      },
    },
  ],
};

const jsonLdBreadcrumb = {
  '@context': 'https://schema.org',
  '@type': 'BreadcrumbList',
  itemListElement: [
    { '@type': 'ListItem', position: 1, name: 'SODU Secure', item: baseUrl },
    { '@type': 'ListItem', position: 2, name: 'Pentest Berlin', item: `${baseUrl}/pentest-berlin` },
    { '@type': 'ListItem', position: 3, name: 'Interner vs. Externer Pentest', item: `${baseUrl}/pentest-berlin/intern-extern` },
  ],
};

export default function InternExternPage() {
  return (
    <>
      <script type="application/ld+json" dangerouslySetInnerHTML={{ __html: JSON.stringify(jsonLdFaq) }} />
      <script type="application/ld+json" dangerouslySetInnerHTML={{ __html: JSON.stringify(jsonLdBreadcrumb) }} />

      <main className="bg-[#0d1117] min-h-screen text-white">

        {/* Breadcrumb */}
        <div className="bg-[#131927] border-b border-gray-800">
          <div className="container mx-auto px-4 sm:px-6 py-3">
            <nav className="flex items-center gap-2 text-sm text-gray-400" aria-label="Breadcrumb">
              <Link href="/" className="hover:text-white transition-colors">SODU Secure</Link>
              <ChevronRight className="w-3 h-3" />
              <Link href="/pentest-berlin" className="hover:text-white transition-colors">Pentest Berlin</Link>
              <ChevronRight className="w-3 h-3" />
              <span className="text-white">Intern vs. Extern</span>
            </nav>
          </div>
        </div>

        {/* Hero */}
        <section className="py-16 sm:py-20 bg-gradient-to-b from-[#131927] to-[#0d1117]">
          <div className="container mx-auto px-4 sm:px-6 max-w-5xl text-center">
            <div className="inline-block bg-purple-600/10 border border-purple-500/30 rounded-full px-4 py-1.5 text-purple-400 text-sm font-medium mb-6">
              Pentest Methodik Berlin
            </div>
            <h1 className="text-3xl sm:text-4xl lg:text-5xl font-bold mb-6 leading-tight">
              Externer vs.{' '}
              <span className="text-red-500">Interner Pentest</span>{' '}
              Berlin
            </h1>
            <p className="text-gray-300 text-lg sm:text-xl max-w-3xl mx-auto mb-8">
              Was ist der Unterschied? Wann brauchen Sie welchen Ansatz?
              Und warum ist die Kombination für Berliner KMUs der goldene Standard?
            </p>
            <div className="flex flex-col sm:flex-row items-center justify-center gap-4">
              <Link
                href="/request-pentest"
                className="inline-flex items-center gap-2 bg-red-600 hover:bg-red-700 text-white px-8 py-3 rounded-lg font-semibold transition-colors text-base"
              >
                <Calculator className="w-5 h-5" />
                Pentest Konfigurieren
              </Link>
              <Link href="/pentest-berlin" className="inline-flex items-center gap-2 text-gray-300 hover:text-white transition-colors text-base">
                ← Pentest Berlin Übersicht
              </Link>
            </div>
          </div>
        </section>

        {/* Head-to-head comparison */}
        <section className="py-16 sm:py-20">
          <div className="container mx-auto px-4 sm:px-6 max-w-5xl">
            <h2 className="text-2xl sm:text-3xl font-bold text-center mb-12">
              Externer vs. Interner Pentest — Direktvergleich
            </h2>
            <div className="overflow-x-auto rounded-xl border border-gray-800">
              <table className="w-full text-sm">
                <thead>
                  <tr className="bg-[#131927] border-b border-gray-800">
                    <th className="text-left p-4 text-gray-400 font-medium w-1/3">Kriterium</th>
                    <th className="text-left p-4 text-blue-400 font-semibold">Externer Pentest</th>
                    <th className="text-left p-4 text-orange-400 font-semibold">Interner Pentest</th>
                  </tr>
                </thead>
                <tbody className="divide-y divide-gray-800">
                  {[
                    ['Angreifer-Perspektive', 'Internet-Angreifer ohne Vorwissen', 'Insider / bereits kompromittierter Account'],
                    ['Angriffsfläche', 'Öffentliche IPs, Domains, VPN, Mail, Webserver', 'Internes Netz, Active Directory, Fileserver, Datenbanken'],
                    ['Typische Methoden', 'Port-Scanning, CVE-Exploitation, Web-Angriffe', 'Kerberoasting, Pass-the-Hash, Privilege Escalation'],
                    ['Voraussetzungen', 'Nur IP-Adressen / Domains', 'VPN-Zugang zum internen Netz'],
                    ['Dauer', '3–7 Werktage', '5–10 Werktage'],
                    ['Preis (Berlin)', 'ab 2.500 €', 'ab 4.500 €'],
                    ['Gut für...', 'Erstprüfung, EAS, Cloud-Absicherung', 'Active Directory, Post-Exploitation, Insider-Threat'],
                    ['NIS2-Relevanz', 'Ja — externe Angriffsfläche', 'Ja — interne Ausbreitung nach Breach'],
                  ].map(([kriterium, extern, intern], i) => (
                    <tr key={i} className={i % 2 === 0 ? 'bg-[#0d1117]' : 'bg-[#0f1520]'}>
                      <td className="p-4 text-gray-400 font-medium">{kriterium}</td>
                      <td className="p-4 text-gray-200">{extern}</td>
                      <td className="p-4 text-gray-200">{intern}</td>
                    </tr>
                  ))}
                </tbody>
              </table>
            </div>
          </div>
        </section>

        {/* Black / Grey / White Box */}
        <section className="py-16 sm:py-20 bg-[#131927]">
          <div className="container mx-auto px-4 sm:px-6 max-w-5xl">
            <h2 className="text-2xl sm:text-3xl font-bold text-center mb-4">Black-Box, Grey-Box oder White-Box?</h2>
            <p className="text-gray-400 text-center max-w-2xl mx-auto mb-12 text-sm sm:text-base">
              Diese drei Ansätze unterscheiden sich im Grad des Vorwissens des Testers — und damit in Tiefe, Dauer und Kosten.
            </p>
            <div className="grid grid-cols-1 sm:grid-cols-3 gap-6">
              {[
                {
                  name: 'Black-Box',
                  color: 'border-red-500',
                  badge: 'bg-red-500',
                  desc: 'Kein Vorwissen. Tester sieht nur den Unternehmensnamen — so wie ein echter Angreifer.',
                  pros: ['Realste Simulation möglich', 'Testet Security ohne Insider-Wissen'],
                  cons: ['Zeitintensiver (mehr Recon-Phase)', 'Möglicherweise nicht alle Bereiche abgedeckt'],
                  ideal: 'Ersttest, externe Angriffsfläche',
                },
                {
                  name: 'Grey-Box',
                  color: 'border-blue-500',
                  badge: 'bg-blue-500',
                  badge2: 'Empfohlen für KMU',
                  desc: 'Teilweises Vorwissen (z.B. normaler Benutzeraccount, Netzwerkplan). Effizienz + Realismus.',
                  pros: ['Effizienter als Black-Box', 'Deckt Insider-Szenarien ab', 'Bestes Kosten-Nutzen-Verhältnis'],
                  cons: ['Erfordert etwas Vorab-Sharing'],
                  ideal: 'KMU-Standardpentest, AD-Tests',
                },
                {
                  name: 'White-Box',
                  color: 'border-green-500',
                  badge: 'bg-green-500',
                  desc: 'Vollständiges Vorwissen: Architektur, Code, Credentials. Tiefste Testabdeckung.',
                  pros: ['Höchste Testtiefe', 'Optimalste Codeanalyse', 'Weniger Lücken bleiben unentdeckt'],
                  cons: ['Teuerster Ansatz', 'Weniger realitätsnah'],
                  ideal: 'ISO 27001, vor Produktionslaunch',
                },
              ].map((box) => (
                <div key={box.name} className={`bg-[#0d1117] rounded-xl border-2 ${box.color} p-6 flex flex-col relative`}>
                  {box.badge2 && (
                    <div className="absolute -top-3 left-1/2 -translate-x-1/2 bg-blue-600 text-white text-xs font-bold px-3 py-1 rounded-full whitespace-nowrap">
                      {box.badge2}
                    </div>
                  )}
                  <span className={`inline-block ${box.badge} text-white text-xs font-semibold px-3 py-1 rounded-full mb-3 self-start`}>{box.name}</span>
                  <p className="text-gray-300 text-sm mb-4">{box.desc}</p>
                  <div className="mb-3">
                    <div className="text-xs font-semibold text-green-400 mb-2">Vorteile</div>
                    <ul className="space-y-1">
                      {box.pros.map((p, i) => (
                        <li key={i} className="flex items-center gap-2 text-xs text-gray-300">
                          <CheckCircle className="w-3.5 h-3.5 text-green-400 shrink-0" /> {p}
                        </li>
                      ))}
                    </ul>
                  </div>
                  <div className="mb-3">
                    <div className="text-xs font-semibold text-red-400 mb-2">Nachteile</div>
                    <ul className="space-y-1">
                      {box.cons.map((c, i) => (
                        <li key={i} className="flex items-center gap-2 text-xs text-gray-300">
                          <X className="w-3.5 h-3.5 text-red-400 shrink-0" /> {c}
                        </li>
                      ))}
                    </ul>
                  </div>
                  <div className="mt-auto pt-4 border-t border-gray-800">
                    <span className="text-xs text-gray-500">Ideal für: </span>
                    <span className="text-xs text-gray-300">{box.ideal}</span>
                  </div>
                </div>
              ))}
            </div>
          </div>
        </section>

        {/* Hybrid approach */}
        <section className="py-16 sm:py-20">
          <div className="container mx-auto px-4 sm:px-6 max-w-4xl">
            <div className="bg-gradient-to-r from-purple-950/40 to-blue-950/30 border border-purple-500/30 rounded-2xl p-8 sm:p-10">
              <h2 className="text-xl sm:text-2xl font-bold text-white mb-4">
                Der goldene Standard: Hybrid-Pentest (Extern + Intern)
              </h2>
              <p className="text-gray-300 text-sm sm:text-base mb-6">
                Für Berliner KMUs empfiehlt SODU Secure den kombinierten Ansatz: Zuerst externer Pentest (Grey-Box), dann interner Active-Directory-Test (Grey-Box). Dieser Hybrid deckt den vollständigen Angriffspfad ab — vom ersten Angriff aus dem Internet bis zur Übernahme des Domain Controllers.
              </p>
              <div className="grid grid-cols-1 sm:grid-cols-3 gap-4 mb-6">
                {[
                  { step: '1', title: 'Externer Pentest', desc: 'Angriff auf öffentliche Oberfläche: IPs, Domains, VPN, Webapps', color: 'text-blue-400' },
                  { step: '2', title: 'Phishing-Simulation', desc: 'Initialer Zugang via Phishing-Mail an Mitarbeiter simuliert', color: 'text-orange-400' },
                  { step: '3', title: 'Interner AD-Pentest', desc: 'Lateral Movement, Kerberoasting, Domain-Übernahme', color: 'text-green-400' },
                ].map((s, i) => (
                  <div key={i} className="bg-[#0d1117] rounded-xl p-4 border border-gray-800">
                    <div className={`text-xl font-bold ${s.color} mb-2`}>{s.step}</div>
                    <div className="font-semibold text-white text-sm mb-1">{s.title}</div>
                    <div className="text-xs text-gray-400">{s.desc}</div>
                  </div>
                ))}
              </div>
              <Link href="/request-pentest" className="inline-flex items-center gap-2 bg-purple-600 hover:bg-purple-700 text-white px-6 py-2.5 rounded-lg font-medium transition-colors text-sm">
                Hybrid-Pentest anfragen
                <ArrowRight className="w-4 h-4" />
              </Link>
            </div>
          </div>
        </section>

        {/* When to choose which */}
        <section className="py-16 sm:py-20 bg-[#131927]">
          <div className="container mx-auto px-4 sm:px-6 max-w-5xl">
            <h2 className="text-2xl sm:text-3xl font-bold text-center mb-12">Wann brauche ich welchen Pentest?</h2>
            <div className="grid grid-cols-1 sm:grid-cols-2 gap-6">
              {[
                { when: 'Externer Pentest empfohlen, wenn...', color: 'border-blue-500', items: ['Sie noch nie einen Pentest hatten', 'Sie neue Webapplikationen launchen', 'Sie Cloud-Infrastruktur absichern wollen', 'Sie NIS2-Compliance nachweisen müssen', 'Ihre Versicherung einen Nachweis fordert'] },
                { when: 'Interner Pentest empfohlen, wenn...', color: 'border-orange-500', items: ['Sie Active Directory betreiben', 'Sie einen Ransomware-Angriff simulieren wollen', 'Insider-Threat ein reales Risiko ist', 'Sie nach einem Incident die eigene Abwehr testen', 'ISO 27001 und ISO 27019 Anforderungen vorliegen'] },
                { when: 'Grey-Box empfohlen, wenn...', color: 'border-purple-500', items: ['Sie ein begrenztes Budget haben', 'Maximale Effizienz bei vorgegebenem Zeitfenster wichtig ist', 'Sie Best-of-both-worlds aus Realismus und Tiefe möchten', 'KMU-Standardpaket gewünscht wird'] },
                { when: 'White-Box empfohlen, wenn...', color: 'border-green-500', items: ['Sie eine ISO 27001 Zertifizierung vorbereiten', 'Sie den Quellcode einer kritischen Anwendung prüfen lassen', 'Sie maximale Testtiefe in regulierten Branchen brauchen', 'DORA oder TIBER-EU Anforderungen gelten'] },
              ].map((item, i) => (
                <div key={i} className={`bg-[#0d1117] rounded-xl border-l-4 ${item.color} border border-gray-800 p-6`}>
                  <h3 className="font-semibold text-white mb-4 text-sm">{item.when}</h3>
                  <ul className="space-y-2">
                    {item.items.map((point, j) => (
                      <li key={j} className="flex items-center gap-2 text-xs text-gray-300">
                        <CheckCircle className="w-3.5 h-3.5 text-green-400 shrink-0" />
                        {point}
                      </li>
                    ))}
                  </ul>
                </div>
              ))}
            </div>
          </div>
        </section>

        {/* FAQ */}
        <section className="py-16 sm:py-20">
          <div className="container mx-auto px-4 sm:px-6 max-w-3xl">
            <h2 className="text-2xl sm:text-3xl font-bold text-center mb-12">Häufige Fragen: Intern vs. Extern</h2>
            <div className="space-y-4">
              {jsonLdFaq.mainEntity.map((qa, i) => (
                <details key={i} className="bg-[#131927] border border-gray-800 rounded-xl p-6 group">
                  <summary className="cursor-pointer font-semibold text-white list-none flex items-center justify-between gap-4">
                    <span>{qa.name}</span>
                    <ChevronRight className="w-4 h-4 text-gray-400 group-open:rotate-90 transition-transform shrink-0" />
                  </summary>
                  <p className="mt-4 text-gray-400 text-sm leading-relaxed">{qa.acceptedAnswer.text}</p>
                </details>
              ))}
            </div>
          </div>
        </section>

        {/* Related cluster */}
        <section className="py-12 bg-[#131927] border-t border-gray-800">
          <div className="container mx-auto px-4 sm:px-6 max-w-5xl">
            <h2 className="text-lg font-semibold text-white mb-6 text-center">Weitere Themen rund um Pentest Berlin</h2>
            <div className="grid grid-cols-1 sm:grid-cols-3 gap-4">
              {[
                { href: '/pentest-berlin/kosten', title: 'Was kostet ein Pentest in Berlin?', desc: 'Transparente Preise, Pakete und Kostenfaktoren für Berliner Unternehmen.' },
                { href: '/pentest-berlin/kmu', title: 'Pentest Berlin für KMU', desc: 'Warum KMUs besonders gefährdet sind und wie ein maßgeschneiderter Pentest schützt.' },
                { href: '/pentest-berlin/iso-27001', title: 'ISO 27001 Pentest Berlin', desc: 'Welche Pentests für ISO 27001 und NIS2-Compliance notwendig sind.' },
              ].map((link) => (
                <Link key={link.href} href={link.href} className="bg-[#0d1117] border border-gray-800 rounded-xl p-5 hover:border-red-500/50 transition-colors group">
                  <div className="flex items-center justify-between mb-2">
                    <h3 className="font-semibold text-white text-sm group-hover:text-red-400 transition-colors">{link.title}</h3>
                    <ArrowRight className="w-4 h-4 text-gray-500 group-hover:text-red-400 transition-colors shrink-0" />
                  </div>
                  <p className="text-xs text-gray-400">{link.desc}</p>
                </Link>
              ))}
            </div>
          </div>
        </section>

        {/* CTA */}
        <section className="py-16 sm:py-20 bg-gradient-to-b from-[#0d1117] to-[#131927]">
          <div className="container mx-auto px-4 sm:px-6 max-w-3xl text-center">
            <h2 className="text-2xl sm:text-3xl font-bold mb-4">Pentest in Berlin konfigurieren</h2>
            <p className="text-gray-400 mb-8 text-sm sm:text-base">
              Kostenloses Erstgespräch — wir helfen Ihnen, den richtigen Pentest-Ansatz für Ihre Infrastruktur zu wählen.
            </p>
            <Link
              href="/request-pentest"
              className="inline-flex items-center gap-2 bg-red-600 hover:bg-red-700 text-white px-8 py-4 rounded-lg font-semibold text-base transition-colors"
            >
              <Calculator className="w-5 h-5" />
              Pentest Kosten Berechnen
              <ArrowRight className="w-5 h-5" />
            </Link>
            <div className="mt-4">
              <Link href="/pentest-berlin" className="text-sm text-gray-500 hover:text-gray-300 transition-colors">
                ← Zurück zur Pentest Berlin Übersicht
              </Link>
            </div>
          </div>
        </section>
      </main>
    </>
  );
}
