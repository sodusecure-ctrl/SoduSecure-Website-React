import { Metadata } from 'next';
import Link from 'next/link';
import { Calculator, CheckCircle, ArrowRight, FileText, Shield, ChevronRight } from 'lucide-react';

const baseUrl = 'https://www.sodusecure.com';

export const metadata: Metadata = {
  title: 'ISO 27001 Pentest Berlin – Anforderungen & Zertifizierungsvorbereitung 2026 | SODU Secure',
  description: 'ISO 27001 Pentest Berlin: Welche Sicherheitstests für die Zertifizierung nach ISO 27001 und NIS2 notwendig sind. SODU Secure begleitet Berliner Unternehmen auf dem Weg zur Compliance.',
  keywords: [
    'ISO 27001 Pentest Berlin',
    'ISO 27001 Penetrationstest Berlin',
    'ISO 27001 Zertifizierung Berlin',
    'NIS2 Pentest Berlin',
    'ISMS Pentest Berlin',
    'Informationssicherheit Berlin',
    'ISO 27001 Annex A Pentest',
    'Compliance Pentest Berlin',
  ],
  alternates: {
    canonical: `${baseUrl}/pentest-berlin/iso-27001`,
  },
  openGraph: {
    title: 'ISO 27001 Pentest Berlin – Anforderungen & Compliance 2026',
    description: 'Welche Pentests für ISO 27001 erforderlich sind, was Annex A 8.8 fordert und wie SODU Secure Berliner Unternehmen zur Zertifizierung begleitet.',
    url: `${baseUrl}/pentest-berlin/iso-27001`,
    type: 'website',
  },
  robots: { index: true, follow: true },
};

const jsonLdFaq = {
  '@context': 'https://schema.org',
  '@type': 'FAQPage',
  mainEntity: [
    {
      '@type': 'Question',
      name: 'Verlangt ISO 27001 explizit einen Penetrationstest?',
      acceptedAnswer: {
        '@type': 'Answer',
        text: 'ISO 27001:2022 verlangt in Annex A 8.8 (Management technischer Schwachstellen) das Identifizieren und Beheben von Schwachstellen in Informationssystemen. Während ein Pentest nicht explizit vorgeschrieben ist, gilt er als einer der stärksten Nachweise für die Umsetzung dieses Controls. Zertifizierungsauditoren erwarten für Umgebungen mit erhöhtem Risikoprofil typischerweise Pentest-Belege.',
      },
    },
    {
      '@type': 'Question',
      name: 'Welche ISO 27001 Controls erfordern einen Pentest?',
      acceptedAnswer: {
        '@type': 'Answer',
        text: 'Die relevantesten Controls: A 8.8 (Management technischer Schwachstellen), A 8.25 (Sicherer Entwicklungslebenszyklus), A 8.29 (Sicherheitstests in Entwicklung und Abnahme), A 5.37 (Dokumentierte Betriebsabläufe) sowie A 5.30 (IKT-Bereitschaft für Business Continuity). Ein Pentest liefert direkte Evidenz für A 8.8 und A 8.29.',
      },
    },
    {
      '@type': 'Question',
      name: 'Wie oft muss ein Pentest für ISO 27001 durchgeführt werden?',
      acceptedAnswer: {
        '@type': 'Answer',
        text: 'ISO 27001 schreibt keine feste Häufigkeit vor, empfiehlt aber regelmäßige Überprüfungen entsprechend dem Risikoniveau. Gängige Praxis: Initialer Pentest vor der Zertifizierung, danach jährlich oder bei wesentlichen Infrastrukturänderungen. Viele Zertifizierungsauditoren akzeptieren einen Pentest-Bericht, der nicht älter als 12 Monate ist.',
      },
    },
    {
      '@type': 'Question',
      name: 'Was ist der Unterschied zwischen einem Pentest für ISO 27001 und NIS2?',
      acceptedAnswer: {
        '@type': 'Answer',
        text: 'ISO 27001 ist eine freiwillige Norm für ein Informationssicherheits-Managementsystem (ISMS). NIS2 hingegen ist eine EU-Richtlinie mit gesetzlichen Pflichten. Beide erfordern technische Sicherheitsmaßnahmen. Ein Pentest-Bericht kann für beide Zwecke als Nachweis dienen — idealerweise nach Absprache mit dem Auditor.',
      },
    },
    {
      '@type': 'Question',
      name: 'Kann SODU Secure uns auf die ISO 27001 Zertifizierung vorbereiten?',
      acceptedAnswer: {
        '@type': 'Answer',
        text: 'SODU Secure führt den technischen Pentest durch und liefert einen strukturierten Bericht, der als Evidenz im ISMS-Audit einsetzbar ist. Wir dokumentieren Findings nach CVSS 3.1, geben Maßnahmenempfehlungen und führen auf Wunsch ein Re-Test-Check durch. Für ISMS-Aufbau und ISO 27001 Gap-Analyse empfehlen wir einen Compliance-spezialisierten Partner.',
      },
    },
  ],
};

const jsonLdBreadcrumb = {
  '@context': 'https://schema.org',
  '@type': 'BreadcrumbList',
  itemListElement: [
    { '@type': 'ListItem', position: 1, name: 'SODU Secure', item: baseUrl },
    { '@type': 'ListItem', position: 2, name: 'Pentest Berlin', item: `${baseUrl}/pentest-berlin` },
    { '@type': 'ListItem', position: 3, name: 'ISO 27001 Pentest Berlin', item: `${baseUrl}/pentest-berlin/iso-27001` },
  ],
};

const relevantControls = [
  {
    id: 'A 8.8',
    title: 'Management technischer Schwachstellen',
    desc: 'Informationen über technische Schwachstellen in genutzten Systemen müssen zeitnah beschafft, das Risikoniveau bewertet und geeignete Maßnahmen ergriffen werden.',
    pentest: 'Direkte Evidenz durch Schwachstellenidentifikation + CVSS-Bewertung im Pentest-Bericht.',
    strong: true,
  },
  {
    id: 'A 8.29',
    title: 'Sicherheitstests in Entwicklung & Abnahme',
    desc: 'Sicherheitstests müssen in der Entwicklung und beim Release neuer oder geänderter Systeme durchgeführt werden.',
    pentest: 'Web-Application-Pentest und API-Sicherheitstest als Abnahmetest vor Go-Live.',
    strong: true,
  },
  {
    id: 'A 8.25',
    title: 'Sicherer Entwicklungslebenszyklus',
    desc: 'Regeln für die sichere Softwareentwicklung müssen festgelegt und angewendet werden.',
    pentest: 'White-Box-Pentest mit Source-Code-Review als SSDLC-Werkzeug.',
    strong: false,
  },
  {
    id: 'A 5.37',
    title: 'Dokumentierte Betriebsabläufe',
    desc: 'Betriebsverfahren für IT-Systeme müssen dokumentiert und verfügbar sein.',
    pentest: 'Pentest-Bericht als dokumentierter Nachweis der Sicherheitsüberprüfung.',
    strong: false,
  },
  {
    id: 'A 5.30',
    title: 'IKT-Bereitschaft für Business Continuity',
    desc: 'Die IKT-Bereitschaft muss geplant, implementiert, bewertet und kontinuierlich verbessert werden.',
    pentest: 'Red-Team-Übungen und Incident-Response-Szenarien aus Pentest-Ergebnissen.',
    strong: false,
  },
  {
    id: 'A 8.2',
    title: 'Privilegierte Zugriffsrechte',
    desc: 'Zuweisung und Nutzung privilegierter Zugangsdaten müssen eingeschränkt und verwaltet werden.',
    pentest: 'Active-Directory-Pentest prüft Privilege-Escalation-Pfade und PAM-Konfigurationen.',
    strong: true,
  },
];

export default function Iso27001Page() {
  return (
    <>
      <script type="application/ld+json" dangerouslySetInnerHTML={{ __html: JSON.stringify(jsonLdFaq) }} />
      <script type="application/ld+json" dangerouslySetInnerHTML={{ __html: JSON.stringify(jsonLdBreadcrumb) }} />

      <main className="bg-[#0d1117] min-h-screen text-white">

        {/* Breadcrumb */}
        <div className="bg-[#131927] border-b border-gray-800">
          <div className="container mx-auto px-4 sm:px-6 py-3">
            <nav className="flex items-center gap-2 text-sm text-gray-400" aria-label="Breadcrumb">
              <Link href="/" className="hover:text-white transition-colors">SODU Secure</Link>
              <ChevronRight className="w-3 h-3" />
              <Link href="/pentest-berlin" className="hover:text-white transition-colors">Pentest Berlin</Link>
              <ChevronRight className="w-3 h-3" />
              <span className="text-white">ISO 27001 Pentest</span>
            </nav>
          </div>
        </div>

        {/* Hero */}
        <section className="py-16 sm:py-20 bg-gradient-to-b from-[#131927] to-[#0d1117]">
          <div className="container mx-auto px-4 sm:px-6 max-w-5xl text-center">
            <div className="inline-block bg-indigo-600/10 border border-indigo-500/30 rounded-full px-4 py-1.5 text-indigo-400 text-sm font-medium mb-6">
              ISO 27001 · NIS2 · DSGVO
            </div>
            <h1 className="text-3xl sm:text-4xl lg:text-5xl font-bold mb-6 leading-tight">
              ISO 27001 Pentest{' '}
              <span className="text-red-500">Berlin</span>
            </h1>
            <p className="text-gray-300 text-lg sm:text-xl max-w-3xl mx-auto mb-8">
              Welche Sicherheitstests für die ISO 27001 Zertifizierung erforderlich sind, welche Controls einen Pentest verlangen und
              wie SODU Secure Berliner Unternehmen audit-ready macht.
            </p>
            <div className="flex flex-col sm:flex-row items-center justify-center gap-4">
              <Link
                href="/request-pentest"
                className="inline-flex items-center gap-2 bg-red-600 hover:bg-red-700 text-white px-8 py-3 rounded-lg font-semibold transition-colors text-base"
              >
                <Calculator className="w-5 h-5" />
                Compliance-Pentest Anfragen
              </Link>
              <Link href="/pentest-berlin" className="inline-flex items-center gap-2 text-gray-300 hover:text-white transition-colors text-base">
                ← Pentest Berlin Übersicht
              </Link>
            </div>
          </div>
        </section>

        {/* Quick explanation */}
        <section className="py-12 bg-[#131927] border-y border-gray-800">
          <div className="container mx-auto px-4 sm:px-6 max-w-5xl">
            <div className="grid grid-cols-1 sm:grid-cols-3 gap-6 text-center">
              {[
                { icon: FileText, title: 'ISO 27001:2022', desc: 'Internationale Norm für Informationssicherheits-Management (ISMS). Annex A 8.8 und 8.29 fordern technische Schwachstellenprüfungen.' },
                { icon: Shield, title: 'NIS2-Richtlinie', desc: 'EU-Richtlinie mit Gesetzeskraft. Art. 21 fordert technische Risikomanagementmaßnahmen — Pentests sind stärkster Nachweis.' },
                { icon: FileText, title: 'DSGVO Art. 32', desc: 'Technische und organisatorische Maßnahmen (TOMs) zur Datensicherheit. Ein Pentest zeigt, dass TOMs wirksam implementiert sind.' },
              ].map((item, i) => (
                <div key={i} className="bg-[#0d1117] rounded-xl p-6 border border-gray-800">
                  <item.icon className="w-8 h-8 text-indigo-400 mx-auto mb-3" />
                  <h3 className="font-semibold text-white mb-2 text-sm">{item.title}</h3>
                  <p className="text-xs text-gray-400 leading-relaxed">{item.desc}</p>
                </div>
              ))}
            </div>
          </div>
        </section>

        {/* ISO 27001 Controls */}
        <section className="py-16 sm:py-20">
          <div className="container mx-auto px-4 sm:px-6 max-w-5xl">
            <h2 className="text-2xl sm:text-3xl font-bold text-center mb-4">
              Welche ISO 27001 Controls{' '}
              <span className="text-red-500">einen Pentest verlangen</span>
            </h2>
            <p className="text-gray-400 text-center max-w-2xl mx-auto mb-12 text-sm sm:text-base">
              ISO 27001:2022 enthält 93 Controls in 4 Domänen. Diese 6 sind direkt durch einen Pentest adressierbar — 3 davon sind besonders relevant für Auditoren.
            </p>
            <div className="space-y-4">
              {relevantControls.map((c, i) => (
                <div key={i} className={`bg-[#131927] rounded-xl border ${c.strong ? 'border-indigo-500/40' : 'border-gray-800'} p-6`}>
                  <div className="flex items-start gap-4">
                    <div className={`shrink-0 ${c.strong ? 'bg-indigo-600' : 'bg-gray-700'} text-white text-xs font-bold px-2.5 py-1 rounded-md`}>
                      {c.id}
                    </div>
                    <div className="flex-1">
                      <div className="flex items-center gap-2 mb-1">
                        <h3 className="font-semibold text-white text-sm">{c.title}</h3>
                        {c.strong && <span className="text-xs bg-indigo-600/20 text-indigo-300 border border-indigo-500/30 px-2 py-0.5 rounded-full">Besonders relevant</span>}
                      </div>
                      <p className="text-xs text-gray-400 mb-3">{c.desc}</p>
                      <div className="flex items-start gap-2">
                        <CheckCircle className="w-3.5 h-3.5 text-green-400 shrink-0 mt-0.5" />
                        <p className="text-xs text-green-300">{c.pentest}</p>
                      </div>
                    </div>
                  </div>
                </div>
              ))}
            </div>
            <p className="text-xs text-gray-500 mt-4">
              Quelle: DIN EN ISO/IEC 27001:2023, Annex A —{' '}
              <a href="https://www.din.de/de/mitwirken/normenausschuesse/nia/normen/wdc-beuth:din21:374453687" target="_blank" rel="noopener noreferrer" className="text-indigo-400 hover:text-indigo-300 underline">
                din.de
              </a>
            </p>
          </div>
        </section>

        {/* NIS2 vs ISO 27001 */}
        <section className="py-16 sm:py-20 bg-[#131927]">
          <div className="container mx-auto px-4 sm:px-6 max-w-5xl">
            <h2 className="text-2xl sm:text-3xl font-bold text-center mb-12">ISO 27001 vs. NIS2 — Was ist der Unterschied?</h2>
            <div className="overflow-x-auto rounded-xl border border-gray-800">
              <table className="w-full text-sm">
                <thead>
                  <tr className="bg-[#0d1117] border-b border-gray-800">
                    <th className="text-left p-4 text-gray-400 font-medium">Kriterium</th>
                    <th className="text-left p-4 text-indigo-400 font-semibold">ISO 27001:2022</th>
                    <th className="text-left p-4 text-blue-400 font-semibold">NIS2-Richtlinie</th>
                  </tr>
                </thead>
                <tbody className="divide-y divide-gray-800">
                  {[
                    ['Rechtlicher Status', 'Freiwillige internationale Norm', 'EU-Richtlinie (gesetzliche Pflicht)'],
                    ['Zielgruppe', 'Alle Organisationen weltweit', 'Bestimmte Sektoren/Größen in der EU'],
                    ['Ziel', 'ISMS-Zertifizierung + Vertrauensnachweis', 'Cybersicherheitspflichten im öffentlichen Interesse'],
                    ['Pentest gefordert?', 'Indirekt (Annex A 8.8, 8.29)', 'Indirekt (Art. 21 "angemessene Maßnahmen")'],
                    ['Sanktionen', 'Kein Zertifikat / Auditergebnis', 'Bis zu 10 Mio. € oder 2 % Jahresumsatz'],
                    ['Berlin-Relevanz', 'Wettbewerbsvorteil, Versicherung, Tender', 'NIS2-UmsuCG: Pflicht für relevante Sektoren'],
                  ].map(([kriterium, iso, nis2], i) => (
                    <tr key={i} className={i % 2 === 0 ? 'bg-[#131927]' : 'bg-[#0f1520]'}>
                      <td className="p-4 text-gray-400 font-medium">{kriterium}</td>
                      <td className="p-4 text-gray-200">{iso}</td>
                      <td className="p-4 text-gray-200">{nis2}</td>
                    </tr>
                  ))}
                </tbody>
              </table>
            </div>
          </div>
        </section>

        {/* Process */}
        <section className="py-16 sm:py-20">
          <div className="container mx-auto px-4 sm:px-6 max-w-4xl">
            <h2 className="text-2xl sm:text-3xl font-bold text-center mb-12">
              Wie SODU Secure ISO 27001 Audit-Readiness unterstützt
            </h2>
            <div className="space-y-4">
              {[
                { step: '1', title: 'Scope-Gespräch & Risikoanalyse', desc: 'Kostenlos (30 Min.). Wir klären, welche Systeme im ISMS-Scope sind und welche Controls bereits umgesetzt sind.', extra: '' },
                { step: '2', title: 'Pentest-Durchführung', desc: 'Grey-Box-Pentest auf alle relevanten Systeme (Extern, Active Directory, Web, Cloud). Testdauer: 5–15 Werktage.', extra: '' },
                { step: '3', title: 'Strukturierter Pentest-Bericht', desc: 'CVSS-bewertete Findings, Risikoeinstufung (kritisch/hoch/mittel/niedrig), Maßnahmenempfehlungen — audit-tauglich aufbereitet.', extra: 'Direkt einsetzbar als ISO 27001 Audit-Evidenz (Annex A 8.8).' },
                { step: '4', title: 'Maßnahmenumsetzung & Re-Test', desc: 'Ihre IT behebt kritische Findings. SODU Secure führt Re-Test durch und stellt eine Bestätigung der Behebung aus.', extra: '' },
                { step: '5', title: 'Optional: Audit-Vorbereitung', desc: 'Wir klären offene Fragen zum Pentest-Bericht mit Ihrem ISO 27001 Auditor und bereiten die Präsentation der Evidenz vor.', extra: '' },
              ].map((s, i) => (
                <div key={i} className="flex gap-4 bg-[#131927] rounded-xl border border-gray-800 p-6">
                  <div className="w-8 h-8 bg-indigo-600 rounded-full flex items-center justify-center text-sm font-bold shrink-0">{s.step}</div>
                  <div>
                    <h3 className="font-semibold text-white text-sm mb-1">{s.title}</h3>
                    <p className="text-xs text-gray-400">{s.desc}</p>
                    {s.extra && <p className="text-xs text-green-300 mt-2">{s.extra}</p>}
                  </div>
                </div>
              ))}
            </div>
          </div>
        </section>

        {/* Pentest in DORA Box */}
        <section className="py-12 bg-[#131927]">
          <div className="container mx-auto px-4 sm:px-6 max-w-4xl">
            <div className="bg-gradient-to-r from-orange-950/30 to-yellow-950/20 border border-orange-500/30 rounded-2xl p-6 sm:p-8">
              <h2 className="text-lg sm:text-xl font-bold text-white mb-3">Auch relevant: DORA (für Finanzdienstleister in Berlin)</h2>
              <p className="text-gray-300 text-sm mb-4">
                Der Digital Operational Resilience Act (DORA) gilt ab Januar 2025 für alle Finanzinstitute in der EU — inkl. Berliner Fintechs, Zahlungsdienstleister und Versicherungen.
                DORA verpflichtet zu{' '}
                <strong className="text-white">regelmäßigen TLPT (Threat-Led Penetration Tests)</strong>{' '}
                nach TIBER-EU-Methodik für bedeutende Institute.
              </p>
              <div className="flex gap-4 flex-wrap">
                <Link href="/request-pentest" className="inline-flex items-center gap-2 bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors">
                  DORA-Pentest anfragen
                </Link>
                <a href="https://www.eba.europa.eu/regulation-and-policy/operational-resilience/guidelines-ict-and-security-risk-management" target="_blank" rel="noopener noreferrer" className="inline-flex items-center gap-2 text-orange-400 hover:text-orange-300 transition-colors text-sm">
                  EBA DORA Guidelines →
                </a>
              </div>
            </div>
          </div>
        </section>

        {/* FAQ */}
        <section className="py-16 sm:py-20">
          <div className="container mx-auto px-4 sm:px-6 max-w-3xl">
            <h2 className="text-2xl sm:text-3xl font-bold text-center mb-12">Häufige Fragen: ISO 27001 Pentest Berlin</h2>
            <div className="space-y-4">
              {jsonLdFaq.mainEntity.map((qa, i) => (
                <details key={i} className="bg-[#131927] border border-gray-800 rounded-xl p-6 group">
                  <summary className="cursor-pointer font-semibold text-white list-none flex items-center justify-between gap-4">
                    <span>{qa.name}</span>
                    <ChevronRight className="w-4 h-4 text-gray-400 group-open:rotate-90 transition-transform shrink-0" />
                  </summary>
                  <p className="mt-4 text-gray-400 text-sm leading-relaxed">{qa.acceptedAnswer.text}</p>
                </details>
              ))}
            </div>
          </div>
        </section>

        {/* Related cluster */}
        <section className="py-12 bg-[#131927] border-t border-gray-800">
          <div className="container mx-auto px-4 sm:px-6 max-w-5xl">
            <h2 className="text-lg font-semibold text-white mb-6 text-center">Weitere Themen rund um Pentest Berlin</h2>
            <div className="grid grid-cols-1 sm:grid-cols-3 gap-4">
              {[
                { href: '/pentest-berlin/kosten', title: 'Was kostet ein Pentest in Berlin?', desc: 'Transparente Preise, Pakete und Kostenfaktoren für Berliner Unternehmen.' },
                { href: '/pentest-berlin/kmu', title: 'Pentest Berlin für KMU', desc: 'Warum KMUs besonders gefährdet sind und wie ein maßgeschneiderter Pentest schützt.' },
                { href: '/pentest-berlin/intern-extern', title: 'Interner vs. Externer Pentest', desc: 'Unterschiede, Vor- und Nachteile und wann welcher Ansatz sinnvoll ist.' },
              ].map((link) => (
                <Link key={link.href} href={link.href} className="bg-[#0d1117] border border-gray-800 rounded-xl p-5 hover:border-red-500/50 transition-colors group">
                  <div className="flex items-center justify-between mb-2">
                    <h3 className="font-semibold text-white text-sm group-hover:text-red-400 transition-colors">{link.title}</h3>
                    <ArrowRight className="w-4 h-4 text-gray-500 group-hover:text-red-400 transition-colors shrink-0" />
                  </div>
                  <p className="text-xs text-gray-400">{link.desc}</p>
                </Link>
              ))}
            </div>
          </div>
        </section>

        {/* CTA */}
        <section className="py-16 sm:py-20 bg-gradient-to-b from-[#0d1117] to-[#131927]">
          <div className="container mx-auto px-4 sm:px-6 max-w-3xl text-center">
            <h2 className="text-2xl sm:text-3xl font-bold mb-4">ISO 27001 konformen Pentest anfragen</h2>
            <p className="text-gray-400 mb-8 text-sm sm:text-base">
              SODU Secure erstellt audit-taugliche Pentestberichte für ISO 27001, NIS2 und DSGVO — direkt einsetzbar als Evidenz im Zertifizierungsaudit.
            </p>
            <Link
              href="/request-pentest"
              className="inline-flex items-center gap-2 bg-red-600 hover:bg-red-700 text-white px-8 py-4 rounded-lg font-semibold text-base transition-colors"
            >
              <Calculator className="w-5 h-5" />
              Compliance-Pentest Konfigurieren
              <ArrowRight className="w-5 h-5" />
            </Link>
            <div className="mt-4">
              <Link href="/pentest-berlin" className="text-sm text-gray-500 hover:text-gray-300 transition-colors">
                ← Zurück zur Pentest Berlin Übersicht
              </Link>
            </div>
          </div>
        </section>
      </main>
    </>
  );
}
